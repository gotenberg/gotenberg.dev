---
id: libreoffice
title: LibreOffice
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

The LibreOffice module interacts with [LibreOffice](https://www.libreoffice.org/) to convert documents to PDF, 
thanks to [unoconv](https://github.com/unoconv/unoconv).

:::info

It starts a dedicated LibreOffice instance for each conversion.

:::

## Properties

```
--libreoffice-disable-routes bool  Disable the routes
```

## Route

`POST /forms/libreoffice/convert`

This route accepts `multipart/form-data` requests and files with the following extensions:

`.bib`&nbsp
`.doc`&nbsp
`.xml`&nbsp
`.docx`&nbsp
`.fodt`&nbsp
`.html`&nbsp
`.ltx`&nbsp
`.txt`&nbsp
`.odt`&nbsp
`.ott`&nbsp
`.pdb`&nbsp
`.pdf`&nbsp
`.psw`&nbsp
`.rtf`&nbsp
`.sdw`&nbsp
`.stw`&nbsp
`.sxw`&nbsp
`.uot`&nbsp
`.vor`&nbsp
`.wps`&nbsp
`.epub`&nbsp
`.png`&nbsp
`.bmp`&nbsp
`.emf`&nbsp
`.eps`&nbsp
`.fodg`&nbsp
`.gif`&nbsp
`.jpg`&nbsp
`.met`&nbsp
`.odd`&nbsp
`.otg`&nbsp
`.pbm`&nbsp
`.pct`&nbsp
`.pgm`&nbsp
`.ppm`&nbsp
`.ras`&nbsp
`.std`&nbsp
`.svg`&nbsp
`.svm`&nbsp
`.swf`&nbsp
`.sxd`&nbsp
`.sxw`&nbsp
`.tiff`&nbsp
`.xhtml`&nbsp
`.xpm`&nbsp
`.fodp`&nbsp
`.potm`&nbsp
`.pot`&nbsp
`.pptx`&nbsp
`.pps`&nbsp
`.ppt`&nbsp
`.pwp`&nbsp
`.sda`&nbsp
`.sdd`&nbsp
`.sti`&nbsp
`.sxi`&nbsp
`.uop`&nbsp
`.wmf`&nbsp
`.csv`&nbsp
`.dbf`&nbsp
`.dif`&nbsp
`.fods`&nbsp
`.ods`&nbsp
`.ots`&nbsp
`.pxl`&nbsp
`.sdc`&nbsp
`.slk`&nbsp
`.stc`&nbsp
`.sxc`&nbsp
`.uos`&nbsp
`.xls`&nbsp
`.xlt`&nbsp
`.xlsx`&nbsp
`.tif`&nbsp
`.jpeg`&nbsp
`.odp`

For instance:

```bash {3-4}
curl \
--request POST 'http://localhost:3000/forms/libreoffice/convert' \
--form 'files=@"/path/to/file.docx"' \
-o my.pdf
```

```bash {3-5}
curl \
--request POST 'http://localhost:3000/forms/libreoffice/convert' \
--form 'files=@"/path/to/file.docx"' \
--form 'files=@"/path/to/file.xlsx"' \
-o my.zip
```

<Tabs
defaultValue="orientation"
values={[
{ label: 'Orientation', value: 'orientation', },
{ label: 'Page Ranges', value: 'page_ranges', },
{ label: 'PDF Format', value: 'pdf_format', },
{ label: 'Merge', value: 'merge', },
]
}>
<TabItem value="orientation">

```
landscape bool  Set the paper orientation to landscape (default false)
```

For instance:

```bash {4}
curl \
--request POST 'http://localhost:3000/forms/libreoffice/convert' \
--form 'files=@"/path/to/file.docx"' \
--form 'landscape="true"' \
-o my.pdf
```

</TabItem>
<TabItem value="page_ranges">

```
nativePageRanges string  Page ranges to print, e.g., '1-4' - empty means all pages
```

For instance:

```bash {4}
curl \
--request POST 'http://localhost:3000/forms/libreoffice/convert' \
--form 'files=@"/path/to/file.docx"' \
--form 'nativePageRanges="1-5"' \
-o my.pdf
```

:::caution

The page ranges are applied to all files independently.

:::

</TabItem>
<TabItem value="pdf_format">

```
nativePdfA1aFormat bool    Use unoconv to convert the resulting PDF to the 'PDF/A-1a' format
pdfFormat          string  The PDF format of the resulting PDF
```

:::caution

You cannot use both form fields.

:::

`nativePdfA1aFormat`

```bash {4}
curl \
--request POST 'http://localhost:3000/forms/libreoffice/convert' \
--form 'files=@"/path/to/file.docx"' \
--form 'nativePdfA1aFormat="true"' \
-o my.pdf
```

`pdfFormat`

```bash {4}
curl \
--request POST 'http://localhost:3000/forms/libreoffice/convert' \
--form 'files=@"/path/to/file.docx"' \
--form 'pdfFormat="PDF/A-1a"' \
-o my.pdf
```

:::info

After a LibreOffice conversion, the PDF engines will convert the resulting PDF to a specific format.

Check the available PDF formats:

* [PDFtk](pdf-engines#pdftk)
* [PDFcpu](pdf-engines#pdfcpu)
* [unoconv](pdf-engines#unoconv)

:::

</TabItem>
<TabItem value="merge">

```
merge bool  Merge all PDF files into an individual PDF file
```

By default, if you send more than one file to convert, the route returns a ZIP archive of the resulting PDF files.
However, you may prefer to merge all the PDF files into an individual PDF file.

For instance:

```bash {5}
curl \
--request POST 'http://localhost:3000/forms/libreoffice/convert' \
--form 'files=@"/path/to/file1.docx"' \
--form 'files=@"/path/to/file2.docx"' \
--form 'merge="true"' \
-o my.pdf
```

:::tip

Gotenberg merges the PDF files alphabetically.

:::

</TabItem>
</Tabs>

## Metric

The LibreOffice module exposes the following metric:

* `{namespace}_unoconv_active_instances_count` - current number of active LibreOffice instances.

See [Prometheus](Prometheus) for more details.
